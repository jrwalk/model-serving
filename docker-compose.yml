version: '3.4'
services:
  box: &box
    image: 'model-serving:latest'
    build:
      dockerfile: ./Dockerfile
      context: .
    volumes:
      - .:/model-serving
    environment:
      - FLASK_ENV='development'
    command: /bin/bash
  test:
    <<: *box
    image: 'model-serving:latest'
    command: "python -m pytest test/"
    volumes:
      - .:/model-serving
  app:
    <<: *box
    ports:
      - "5000:5000"
    command:
      - "python run.py"
